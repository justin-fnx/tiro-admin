# AI 개발 에이전트 규칙 (AGENTS.md | CLAUDE.md | .cursorrules)

> **목적**: 모든 AI 어시스턴트(Claude, Cursor, GPT 등)가 이 저장소에서 작업할 때 반드시 준수해야 하는 규칙들을 정의합니다. 이 문서의 파일명은 AGENTS.md, CLAUDE.md, .cursorrules 등 에이전트가 기본으로 참고하는 파일명이면 무엇이든 될 수 있습니다.
> 프로젝트별 기술 스택이나 구현 세부사항과 무관한 일반적인 개발 원칙과 워크플로우를 다룹니다. 세부사항은 docs 디렉토리를 참고하세요.

---

## 1. 타협 불가능한 황금 규칙

| #  | AI *할 수 있음*                                                            | AI *할 수 없음*                                                                    |
|----|------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
| G-0 | 프로젝트와 관련된 사항에 대해 확신이 없을 경우, 변경하기 전에 개발자에게 명확히 물어보십시오.    |  ❌ 프로젝트 특정 사항에 대해 확신이 없거나 특정 기능/결정에 대한 컨텍스트가 없는 경우 변경하거나 도구를 사용하지 마십시오. |
| G-1 | 관련 소스 디렉토리 내에서만 코드 생성 또는 명시적으로 지정된 파일 내에서만 코드 생성.    | ❌ 테스트 파일(`*.test.*`, `*.spec.*` 등), 스펙 문서나 요구사항 문서를 직접 생성/수정하지 마십시오 (테스트 및 스펙은 인간이 소유). |
| G-2 | 비트리비얼한 편집 코드 근처에 **`AIDEV-NOTE:` 앵커 주석** 추가/업데이트. | ❌ 기존 `AIDEV-` 주석을 삭제하거나 손상시키지 마십시오.                                     |
| G-3 | 린트/스타일 구성을 따르십시오. 프로젝트에서 구성된 린터를 사용하고, 수동으로 코드 재포맷하지 마십시오. | ❌ 코드를 다른 스타일로 재포맷하지 마십시오.                                               |
| G-4 | 300 LOC 이상 또는 3개 이상의 파일 변경 시 **확인 요청**.            | ❌ 인간의 지침 없이 대규모 모듈 리팩토링.                                     |
| G-5 | 현재 작업 컨텍스트 내에서 작업하십시오. 새로 시작하는 것이 더 나을 경우 개발자에게 알리십시오.                                  | ❌ "새 작업" 이후 이전 프롬프트에서 계속 작업하지 마십시오 – 새 세션에서 시작하십시오.      |

---

## 2. 필수 시작 워크플로우

### 작업 시작 시 필수 파일 읽기
모든 작업 시작 전에 다음 파일들을 반드시 읽어 프로젝트 컨텍스트를 파악하십시오:

1. **progress/PROGRESS.md**: 프로젝트 진행 상황과 현재 작업 상태
2. **docs/ARCHITECTURE.md**: 시스템 아키텍처와 컴포넌트 관계
3. **docs/TECHNICAL.md**: 기술 명세와 구현 패턴
4. **docs/UI-DESIGN.md**: UI/UX 기획과 디자인 가이드라인
5. **docs/DATABASE.sql**: 데이터베이스 스키마와 구조

### 변경 사항 적용 전 필수 검증
코드 변경 전에 다음 단계를 반드시 수행하십시오:

1. docs/ARCHITECTURE.md에서 시스템 아키텍처 파악
2. docs/TECHNICAL.md의 기술 명세 준수 확인
3. docs/UI-DESIGN.md의 UI/UX 요구사항 준수 확인
4. 변경 사항이 기존 아키텍처와 일치하는지 검증

---

## 3. 작업 관리 워크플로우

### 필수 작업 흐름
1. **진행 상황 확인**: progress/PROGRESS.md에서 현재 작업 요구사항 파악
2. **기술 명세 확인**: docs/TECHNICAL.md에서 구현 가이드라인 파악
3. **아키텍처 정렬**: docs/ARCHITECTURE.md에 맞춰 컴포넌트 상호작용 확인
4. **진행 상황 업데이트**:
    - progress/PROGRESS.md에 현재 작업 상태 기록
    - 작업을 진행 중으로 표시
    - 하위 작업 완료 추적
    - 차단 요소 문서화
5. **TDD 방식 구현**:
    - 테스트 파일 먼저 생성 (인간 검토 후)
    - 테스트 통과하도록 구현
    - 테스트 완료 시 상태 업데이트

### 코드 변경 후 필수 작업
모든 코드 변경 후에는 다음 작업을 반드시 수행하십시오:

1. docs/ARCHITECTURE.md 읽어서 아키텍처 준수 여부 확인
2. docs/TECHNICAL.md 명세에 맞게 변경사항 검증
3. docs/UI-DESIGN.md의 UI/UX 요구사항 준수 여부 확인
4. progress/PROGRESS.md 업데이트:
    - 현재 진행 상황
    - 새로운 이슈
    - 완료된 항목

---

## 4. 아키텍처 이해 규칙

### 아키텍처 다이어그램 파싱 (docs/ARCHITECTURE.md)
다음 항목을 반드시 추출하고 이해하십시오:

1. **전체 Mermaid 다이어그램 로드 및 파싱**
2. **핵심 요소 추출**:
    - 모듈 경계와 관계
    - 데이터 흐름 패턴
    - 시스템 인터페이스
    - 컴포넌트 의존성
3. **제약조건 준수**: 아키텍처 제약조건에 맞게 변경사항 검증
4. **관심사 분리**: 정의된 관심사 분리 유지

### 오류 처리
1. **파일을 찾을 수 없는 경우**: 중단하고 사용자에게 알림
2. **다이어그램 파싱 실패**: 명확한 설명 요청
3. **아키텍처 위반 감지**: 사용자에게 경고

---

## 5. 앵커 주석 규칙

### 주석 규칙
- AI 및 개발자를 위한 주석에는 `AIDEV-NOTE:`, `AIDEV-TODO:`, `AIDEV-QUESTION:` 접두사 사용
- 간결하게(120자 이내), 기존 앵커는 삭제/손상 금지
- 코드가 복잡/중요/혼란스러울 때 앵커 주석 추가

### 예시
```typescript
// AIDEV-NOTE: 성능상, filter 결과를 바로 반환 (불필요한 중간 배열 생성 방지)
return properties.filter(p => p.isActive);
```

---

## 6. 커밋 규율

- **세분화된 커밋**: 논리적 변경 사항당 하나의 커밋
- **AI 생성 커밋 태그**: e.g., `feat: 숙소 목록 페이지 추가 [AI]`
- **명확한 커밋 메시지**: *왜*를 설명, 이슈/ADR에 링크
- **`git worktree` 사용**: 병렬/장기 브랜치 작업
- **AI 생성 코드 검토**: 이해하지 못한 코드는 병합 금지

---

## 7. 디렉토리별 AGENTS.md 파일 관리

- **특정 디렉토리 내 코드 작업 전 항상 `AGENTS.md` 확인**
- 구조/패턴/중요 구현 변경 시 해당 디렉토리의 `AGENTS.md`에 문서화
- 복잡한 논리/패턴이 있는 디렉토리에 `AGENTS.md`가 없으면 생성 제안

---

## 8. 오류 방지 규칙

### 필수 검증 사항
1. **타입 일관성 확인**: 엄격한 타입 사용, 느슨하거나 불명확한 타입 사용 지양
2. **null/undefined/빈 값 가능성 체크**: 모든 값에 대한 안전 검사
3. **비즈니스 규칙 검증**: 도메인 로직에 맞는 유효성 검사
4. **오류 처리 보장**: 모든 public 메소드에 적절한 에러 핸들링

### SOLID 원칙 준수
- 모든 public 메소드에 대한 단위 테스트 작성 준비 (인간 검토 후)
- 코드 문서화 (예: Javadoc, Doxygen 등)

---

## 9. 일반적인 함정 (피해야 할 패턴)

- 타입 불일치 및 any 사용
- 에러 핸들링 누락
- 환경 변수/엔드포인트 설정 오류
- 테스트/스펙 작성 전체를 AI에 위임(잘못된 자신감 초래)
- 단일 커밋에서 대규모 리팩토링
- 프로젝트 특정 규칙 무시

---

## 10. 문서화 규칙

### 언어 사용 규칙
1. **모든 문서는 한글로 작성**
2. **기술 용어는 필요한 경우 영문 병기**
3. **코드 주석은 한글로 작성**
4. **API 문서는 한글로 작성하고 영문 용어는 그대로 유지**

### 문서 업데이트 규칙
- 구조적 변경 시 관련 문서 동시 업데이트
- 새로운 패턴 도입 시 문서화 필수
- 삭제된 기능은 문서에서도 제거

---

## 11. UI/UX 개발 규칙

### UI 컴포넌트 개발 시 필수 작업
1. **docs/UI-DESIGN.md 파일 읽기**:
    - 화면 구성 확인
    - 상호작용 디자인 확인
    - 반응형 디자인 요구사항 확인
    - 접근성 요구사항 확인

2. **UI 변경 시**:
    - docs/UI-DESIGN.md 파일 업데이트
    - 변경 사항 문서화
    - 기존 요구사항과의 일관성 확인

3. **구현 시 고려사항**:
    - 반응형 디자인 적용
    - 접근성 표준 준수
    - 사용자 경험 최적화
    - 성능 고려

---


## 12. 코드 클리닝(리팩터링) 전략 및 실행 순서

### 코드 클리닝 관리 규칙
- **전용 파일**: 코드 클리닝 과정은 `progress/CODE-CLEANING-{CYCLE-NO}.md` 파일에 별도 관리
- **순차 진행**: 각 단계는 반드시 순차적으로 진행
- **테스트 필수**: 모든 변경 후 테스트 및 빌드 검증 필수
- **사이클 관리**:
    - 기존 미완료 사이클이 있으면 이어서 진행
    - 완료된 사이클이면 다음 번호로 새 파일 생성
    - 첫 시작이면 `progress/CODE-CLEANING-1.md` 생성

### 실행 단계 (필수 순서)

#### 1단계: 미사용 코드 및 레거시 패턴 제거
- 미사용 변수, 함수, import, 타입, 인터페이스, 클래스 전수 조사 후 삭제
- 클래스 컴포넌트 등 레거시 패턴을 함수형 컴포넌트로 전환 또는 제거
- dead code(실행되지 않는 코드) 정리
- **도구 활용**: 정적 분석 도구를 활용하여 미사용 코드 식별 (예: Java의 경우 `unused-code` 플러그인, JavaScript의 경우 `ts-prune`, `ESLint` 등)

#### 2단계: 미사용 라이브러리 및 의존성 정리
- 프로젝트 의존성 관리 파일(예: `build.gradle`, `pom.xml`, `package.json`)에서 실제로 사용되지 않는 라이브러리 식별 후 삭제
- 불필요한 유틸리티 및 헬퍼 라이브러리 정리
- 미사용 타입 정의 제거
- **⚠️ 주의**: 코드 포맷팅/린트 도구는 제거 금지 (예: Prettier, ESLint, Checkstyle 등)
- **⚠️ 주의**: 코드 분석 도구는 글로벌 설치 권장, 프로젝트 의존성에서 제거 가능

#### 3단계: 아키텍처/패턴 위반 코드 수정
- 정해진 패턴을 벗어난 안티패턴 식별 후 표준 패턴에 맞게 수정
- 비즈니스 로직이 컴포넌트에 직접 작성된 경우 서비스로 분리
- docs/ARCHITECTURE.md, docs/TECHNICAL.md 가이드라인 준수

#### 4단계: 파편화된 코드 통합
- 유사 기능의 중복 컴포넌트/서비스/유틸리티 통합
- 네이밍, props, API 등 통일성 확보

#### 5단계: 코드 스타일 및 일관성 정비 (권장)
- 프로젝트 코드 스타일 가이드(예: Prettier, ESLint, Checkstyle 등) 적용
- 네이밍 컨벤션, 파일/폴더 구조, 주석 스타일 일관성 확보
- 코드 문서화 규칙 보완 (예: Javadoc, Doxygen, JSDoc 등)

#### 6단계: 타입 안정성 및 오류 처리 강화 (권장)
- 느슨하거나 불명확한 타입 사용 최소화 (예: `Object`, `dynamic` 또는 명확하지 않은 제네릭 타입)
- null/undefined/빈 값 가능성 및 예외 상황 방어 코드 강화
- Validation, Guard, Error Boundary 점검

#### 7단계: 테스트 및 빌드 검증 (필수)
- 모든 단위/통합/E2E 테스트 실행 후 정상 동작 확인
- 프로젝트 빌드 및 테스트 스크립트 실행 후 성공 확인 (예: `gradle build`, `mvn test`, `npm test` 등)
- 실패 시 즉시 원인 분석 후 수정 및 재검증

### 코드 클리닝 후 필수 작업
- 각 단계별 변경 내역을 명확히 커밋
- PR에 리팩터링 목적/범위/영향도 상세 기술
- 발견된 추가 이슈는 progress/PROGRESS.md에 기록하여 추적

### 기타 사항
- IntelliJ IDEA, VSCode 등 IDE의 코드 클리닝 도구 사용 권장
- IDE MCP (jetbrains 등) 도구를 적극 활용하여 업무 효율 향상 (단, 일반적인 코드 생성 / 수정에는 자체 수정 도구를 사용하고 MCP를 사용하지 않는다.)
- Deprecated API 사용 시 context7 MCP를 활용하여 최신 API로 대체

---

## 13. 작업 종료 시 체크리스트

모든 작업 완료 전에 다음 사항을 확인하십시오:

- [ ] progress/PROGRESS.md 업데이트 완료
- [ ] 관련 문서 동기화 완료
- [ ] 아키텍처 제약조건 준수 확인
- [ ] 앵커 주석 추가 (복잡한 로직의 경우)
- [ ] 린트/포맷팅 규칙 준수
- [ ] 커밋 메시지에 AI 태그 추가

대규모 작업이 완료 되었다면 코드 클리닝을 추가로 실행하십시오.

---

*이 규칙들은 프로젝트의 기술 스택이나 도메인과 무관하게 모든 AI 개발 에이전트가 준수해야 하는 일반적인 원칙들입니다.*